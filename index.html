<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário para Visto Americano</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        /* Estilos Globais */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }

        .container {
            background-color: #ffffff;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
            max-width: 850px;
            width: 100%;
            margin-top: 20px;
            margin-bottom: 20px;
            box-sizing: border-box;
        }

        h1 {
            color: #003087; /* Azul mais escuro para o título principal */
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.2em;
            font-weight: 700;
        }

        h3 {
            color: #0056b3; /* Azul para títulos de seção */
            border-bottom: 3px solid #0056b3;
            padding-bottom: 10px;
            margin-top: 35px;
            margin-bottom: 25px;
            font-size: 1.6em;
        }

        h4 {
            color: #007bff; /* Azul mais claro para subtítulos */
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        p {
            margin-bottom: 15px;
            font-size: 1em;
            color: #555;
        }

        label {
            display: block;
            margin: 15px 0 8px;
            font-weight: 600;
            color: #444;
            font-size: 0.95em;
        }

        input[type="text"],
        input[type="date"],
        input[type="tel"],
        input[type="email"],
        textarea,
        select {
            width: calc(100% - 20px); /* Ajuste para padding */
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            box-sizing: border-box; /* Garante que padding e border estejam incluídos na largura */
        }

        input[type="text"]:focus,
        input[type="date"]:focus,
        input[type="tel"]:focus,
        input[type="email"]:focus,
        textarea:focus,
        select:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);
            outline: none;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        input[type="checkbox"] {
            width: auto;
            margin-right: 10px;
            transform: scale(1.2); /* Aumenta o tamanho do checkbox */
            vertical-align: middle;
            margin-top: -3px; /* Pequeno ajuste vertical */
        }

        button[type="submit"] {
            background-color: #28a745; /* Um verde vibrante para o botão de enviar */
            color: white;
            padding: 15px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.2s ease;
            width: 100%;
            margin-top: 30px;
        }

        button[type="submit"]:hover {
            background-color: #218838; /* Um verde um pouco mais escuro no hover */
            transform: translateY(-2px); /* Efeito de elevação sutil */
        }

        hr {
            border: 0;
            border-top: 2px dashed #e0e0e0; /* Linha tracejada suave */
            margin: 40px 0;
        }

        /* Estilos para seções que podem ser ocultadas/exibidas */
        #spouseInfo, #spouseDeathInfo, #parentsInfo, #previousUSVisaInfo, #travelCompanionsInfo,
        #visaDeniedDetails, #payerInfo, #payerAddressInfo, #renewalInfo, #parentsInUSInfo, #acquaintancesInfo {
            background-color: #f9f9f9;
            border: 1px dashed #ddd;
            border-radius: 8px;
            padding: 0 20px; /* Inicialmente padding vertical 0 para transição suave */
            margin-top: 0; /* Inicialmente margin-top 0 para transição suave */
            transition: all 0.4s ease-in-out; /* Transição suave */
            overflow: hidden; /* Importante para que max-height funcione */
            max-height: 0;
            opacity: 0;
            visibility: hidden;
        }

        .section-visible {
            max-height: 1000px; /* Valor grande o suficiente para a altura máxima */
            opacity: 1;
            visibility: visible;
            padding: 20px; /* Retorna o padding normal */
            margin-top: 20px; /* Retorna a margem normal */
        }

        /* Estilos para a declaração */
        .declaration-section {
            background-color: #e6f7ff; /* Fundo azul claro para a declaração */
            border: 1px solid #99d6ff;
            border-radius: 8px;
            padding: 25px;
            margin-top: 40px;
        }

        .declaration-section ol {
            padding-left: 25px;
            margin-bottom: 20px;
            font-size: 0.95em;
            color: #444;
        }

        .declaration-section ol li {
            margin-bottom: 8px;
        }

        .declaration-section p {
            margin-bottom: 10px;
            font-size: 0.98em;
        }

        .declaration-section strong {
            color: #0056b3;
        }

        .declaration-section input[type="text"][name="declaracaoNome"],
        .declaration-section input[type="text"][name="declaracaoLocal"],
        .declaration-section input[type="date"][name="declaracaoData"] {
            width: auto; /* Permite que o input se ajuste ao conteúdo */
            display: inline-block; /* Alinha com o texto */
            padding: 8px;
            font-size: 0.9em;
            border-radius: 5px;
        }

        .declaration-section input[type="checkbox"] {
            vertical-align: middle;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Formulário para Visto Americano</h1>
        <p>Preencha os dados abaixo. Ao clicar em "Enviar", um PDF detalhado será gerado, baixado automaticamente e uma mensagem será enviada ao WhatsApp com os dados básicos e um link para o PDF.</p>

        <form id="visaForm" name="visaForm" method="POST">
            <h3>Informações Pessoais</h3>
            <label for="nome">Nome completo (como no passaporte):</label>
            <input type="text" id="nome" name="nome">

            <label for="sobrenome">Sobrenome (como no passaporte):</label>
            <input type="text" id="sobrenome" name="sobrenome">

            <label for="outrosNomes">Já usou outros nomes? (ex.: nome de solteiro, apelido):</label>
            <input type="text" id="outrosNomes" name="outrosNomes">

            <label for="cpf">CPF:</label>
            <input type="text" id="cpf" name="cpf" maxlength="14" oninput="formatCPF(this)">

            <label for="nascimento">Data de nascimento:</label>
            <input type="date" id="nascimento" name="nascimento">

            <label for="localNascimento">Cidade e país de nascimento:</label>
            <input type="text" id="localNascimento" name="localNascimento">

            <label for="sexo">Sexo:</label>
            <select id="sexo" name="sexo">
                <option value="">Selecione</option>
                <option value="Masculino">Masculino</option>
                <option value="Feminino">Feminino</option>
                <option value="Outro">Outro</option>
            </select>

            <label for="estadoCivil">Estado civil:</label>
            <select id="estadoCivil" name="estadoCivil">
                <option value="">Selecione</option>
                <option value="Solteiro">Solteiro</option>
                <option value="Casado">Casado</option>
                <option value="Divorciado">Divorciado</option>
                <option value="Viúvo">Viúvo</option>
                <option value="União Estável">União Estável</option>
            </select>

            <div id="spouseInfo">
                <h4>Dados do Cônjuge</h4>
                <label for="spouseNome">Nome completo do cônjuge:</label>
                <input type="text" id="spouseNome" name="spouseNome">

                <label for="spouseNascimento">Data de nascimento do cônjuge:</label>
                <input type="date" id="spouseNascimento" name="spouseNascimento">

                <label for="spouseLocalNascimento">Cidade e país de nascimento do cônjuge:</label>
                <input type="text" id="spouseLocalNascimento" name="spouseLocalNascimento">

                <div id="spouseDeathInfo">
                    <label for="spouseFalecimento">Data de falecimento do cônjuge:</label>
                    <input type="date" id="spouseFalecimento" name="spouseFalecimento">
                </div>
            </div>
            <hr>

            <label for="nacionalidade">Nacionalidade atual:</label>
            <input type="text" id="nacionalidade" name="nacionalidade">

            <label for="outrasNacionalidades">Possui outras nacionalidades? (Se sim, quais?):</label>
            <input type="text" id="outrasNacionalidades" name="outrasNacionalidades">

            <label for="passaporte">Número do passaporte:</label>
            <input type="text" id="passaporte" name="passaporte">

            <label for="dataEmissaoPassaporte">Data de emissão do passaporte:</label>
            <input type="date" id="dataEmissaoPassaporte" name="dataEmissaoPassaporte">

            <label for="dataValidadePassaporte">Data de validade do passaporte:</label>
            <input type="date" id="dataValidadePassaporte" name="dataValidadePassaporte">

            <label for="localEmissaoPassaporte">Local de emissão do passaporte:</label>
            <input type="text" id="localEmissaoPassaporte" name="localEmissaoPassaporte">

            <h3>Informações de Contato</h3>
            <label for="cep">CEP (ex.: 70.340-902):</label>
            <input type="text" id="cep" name="cep" maxlength="10" oninput="formatCEP(this)">

            <label for="endereco">Endereço completo (rua, número, bairro):</label>
            <textarea id="endereco" name="endereco"></textarea>

            <label for="cidade">Cidade:</label>
            <input type="text" id="cidade" name="cidade">

            <label for="estado">Estado/Província:</label>
            <input type="text" id="estado" name="estado">

            <label for="pais">País:</label>
            <input type="text" id="pais" name="pais">

            <label for="telefone">Número de telefone (com código do país):</label>
            <input type="tel" id="telefone" name="telefone">

            <label for="email">E-mail:</label>
            <input type="email" id="email" name="email">

            <h3>Informações Familiares</h3>
            <label for="temPaisVivos">Seus pais estão vivos?</label>
            <select id="temPaisVivos" name="temPaisVivos">
                <option value="">Selecione</option>
                <option value="Sim">Sim</option>
                <option value="Não">Não</option>
            </select>

            <div id="parentsInfo">
                <label for="nomePai">Nome completo do pai:</label>
                <input type="text" id="nomePai" name="nomePai">

                <label for="nascimentoPai">Data de nascimento do pai:</label>
                <input type="date" id="nascimentoPai" name="nascimentoPai">

                <label for="nomeMae">Nome completo da mãe:</label>
                <input type="text" id="nomeMae" name="nomeMae">

                <label for="nascimentoMae">Data de nascimento da mãe:</label>
                <input type="date" id="nascimentoMae" name="nascimentoMae">

                <label for="paisNosEUA">Seus pais estão nos EUA?</label>
                <select id="paisNosEUA" name="paisNosEUA">
                    <option value="">Selecione</option>
                    <option value="Sim">Sim</option>
                    <option value="Não">Não</option>
                </select>

                <div id="parentsInUSInfo">
                    <label for="explicacaoPaisEUA">Explique a situação dos seus pais nos EUA:</label>
                    <textarea id="explicacaoPaisEUA" name="explicacaoPaisEUA"></textarea>
                </div>
            </div>

            <label for="temConhecidosEUA">Tem conhecidos nos EUA?</label>
            <select id="temConhecidosEUA" name="temConhecidosEUA">
                <option value="">Selecione</option>
                <option value="Sim">Sim</option>
                <option value="Não">Não</option>
            </select>

            <div id="acquaintancesInfo">
                <h4>Dados do Conhecido nos EUA</h4>
                <label for="nomeConhecido">Nome completo do conhecido:</label>
                <input type="text" id="nomeConhecido" name="nomeConhecido">

                <label for="telefoneConhecido">Telefone do conhecido (com código do país):</label>
                <input type="tel" id="telefoneConhecido" name="telefoneConhecido">

                <label for="emailConhecido">E-mail do conhecido:</label>
                <input type="email" id="emailConhecido" name="emailConhecido">

                <label for="vinculoConhecido">Vínculo com o solicitante (ex.: amigo, parente):</label>
                <input type="text" id="vinculoConhecido" name="vinculoConhecido">
            </div>

            <h3>Detalhes da Viagem</h3>
            <label for="objetivo">Objetivo da viagem aos EUA:</label>
            <select id="objetivo" name="objetivo">
                <option value="">Selecione</option>
                <option value="Turismo">Turismo</option>
                <option value="Negócios">Negócios</option>
                <option value="Estudo">Estudo</option>
                <option value="Trabalho">Trabalho</option>
                <option value="Visita a Familiares">Visita a Familiares</option>
                <option value="Outro">Outro</option>
            </select>

            <label for="chegada">Data prevista de chegada aos EUA:</label>
            <input type="date" id="chegada" name="chegada">

            <label for="tempo">Quanto tempo pretende ficar nos EUA? (ex.: 2 semanas, 6 meses):</label>
            <input type="text" id="tempo" name="tempo">

            <label for="enderecoEUA">Endereço onde ficará nos EUA (rua, cidade, estado, CEP):</label>
            <textarea id="enderecoEUA" name="enderecoEUA" placeholder="Digite o endereço, se disponível (Não obrigatório)"></textarea>

            <label for="quemPaga">Quem está pagando pela viagem?</label>
            <select id="quemPaga" name="quemPaga">
                <option value="">Selecione</option>
                <option value="Eu mesmo">Eu mesmo</option>
                <option value="Outra pessoa">Outra pessoa</option>
            </select>

            <div id="payerInfo">
                <h4>Dados da Pessoa Pagante</h4>
                <label for="payerNome">Nome completo da pessoa pagante:</label>
                <input type="text" id="payerNome" name="payerNome">

                <label for="payerSameAddress">O endereço é o mesmo do solicitante?</label>
                <select id="payerSameAddress" name="payerSameAddress">
                    <option value="">Selecione</option>
                    <option value="Sim">Sim</option>
                    <option value="Não">Não</option>
                </select>

                <div id="payerAddressInfo">
                    <label for="payerCEP">CEP (ex.: 70.340-902):</label>
                    <input type="text" id="payerCEP" name="payerCEP" maxlength="10" oninput="formatCEP(this)">

                    <label for="payerEndereco">Endereço completo (rua, número, bairro):</label>
                    <textarea id="payerEndereco" name="payerEndereco"></textarea>

                    <label for="payerCidade">Cidade:</label>
                    <input type="text" id="payerCidade" name="payerCidade">

                    <label for="payerEstado">Estado/Província:</label>
                    <input type="text" id="payerEstado" name="payerEstado">

                    <label for="payerPais">País:</label>
                    <input type="text" id="payerPais" name="payerPais">
                </div>

                <label for="payerEmail">E-mail da pessoa pagante:</label>
                <input type="email" id="payerEmail" name="payerEmail">

                <label for="payerTelefone">Telefone da pessoa pagante (com código do país):</label>
                <input type="tel" id="payerTelefone" name="payerTelefone">

                <label for="payerVinculo">Vínculo com o solicitante (ex.: pai, amigo, empregador):</label>
                <input type="text" id="payerVinculo" name="payerVinculo">
            </div>

            <label for="temCompanheiros">Vai viajar com alguém?</label>
            <select id="temCompanheiros" name="temCompanheiros">
                <option value="">Selecione</option>
                <option value="Sim">Sim</option>
                <option value="Não">Não</option>
            </select>

            <div id="travelCompanionsInfo">
                <label for="nomeCompanheiro">Nome completo do(s) companheiro(s) de viagem:</label>
                <textarea id="nomeCompanheiro" name="nomeCompanheiro"></textarea>

                <label for="relacaoCompanheiro">Relação com o(s) companheiro(s) (ex.: amigo, colega):</label>
                <input type="text" id="relacaoCompanheiro" name="relacaoCompanheiro">
            </div>

            <h3>Informações de Trabalho</h3>
            <label for="ocupacao">Ocupação atual:</label>
            <input type="text" id="ocupacao" name="ocupacao">

            <label for="empregador">Nome do empregador:</label>
            <input type="text" id="empregador" name="empregador">

            <label for="enderecoEmpregador">Endereço do empregador:</label>
            <textarea id="enderecoEmpregador" name="enderecoEmpregador"></textarea>

            <label for="telefoneEmpregador">Telefone do empregador:</label>
            <input type="tel" id="telefoneEmpregador" name="telefoneEmpregador">

            <label for="dataInicioTrabalho">Data de início no emprego:</label>
            <input type="date" id="dataInicioTrabalho" name="dataInicioTrabalho">

            <label for="rendaMensal">Renda mensal (em reais):</label>
            <input type="text" id="rendaMensal" name="rendaMensal">

            <h3>Informações de Educação</h3>
            <label for="nivelEducacao">Nível mais alto de educação concluído:</label>
            <select id="nivelEducacao" name="nivelEducacao">
                <option value="">Selecione</option>
                <option value="Ensino Fundamental">Ensino Fundamental</option>
                <option value="Ensino Médio">Ensino Médio</option>
                <option value="Ensino Superior">Ensino Superior</option>
                <option value="Pós-Graduação">Pós-Graduação</option>
            </select>

            <label for="instituicao">Nome da instituição educacional:</label>
            <input type="text" id="instituicao" name="instituicao">

            <label for="enderecoInstituicao">Endereço da instituição:</label>
            <textarea id="enderecoInstituicao" name="enderecoInstituicao"></textarea>

            <label for="dataInicioEducacao">Data de início do curso:</label>
            <input type="date" id="dataInicioEducacao" name="dataInicioEducacao">

            <label for="dataFimEducacao">Data de conclusão do curso:</label>
            <input type="date" id="dataFimEducacao" name="dataFimEducacao">

            <h3>Histórico de Viagens</h3>
            <label for="primeiroVisto">É o seu primeiro visto ou uma renovação?</label>
            <select id="primeiroVisto" name="primeiroVisto">
                <option value="">Selecione</option>
                <option value="Primeiro visto">Primeiro visto</option>
                <option value="Renovação">Renovação</option>
            </select>

            <div id="renewalInfo">
                <label for="numeroVistoAnteriorRenovacao">Número do visto anterior:</label>
                <input type="text" id="numeroVistoAnteriorRenovacao" name="numeroVistoAnteriorRenovacao">

                <label for="dataEmissaoVistoAnterior">Data de emissão do visto anterior:</label>
                <input type="date" id="dataEmissaoVistoAnterior" name="dataEmissaoVistoAnterior">

                <label for="dataValidadeVistoAnterior">Data de validade do visto anterior:</label>
                <input type="date" id="dataValidadeVistoAnterior" name="dataValidadeVistoAnterior">

                <label for="localEmissaoVistoAnterior">Local de emissão do visto anterior:</label>
                <input type="text" id="localEmissaoVistoAnterior" name="localEmissaoVistoAnterior">
            </div>

            <label for="visitouEUA">Já visitou os EUA antes?</label>
            <select id="visitouEUA" name="visitouEUA">
                <option value="">Selecione</option>
                <option value="Sim">Sim</option>
                <option value="Não">Não</option>
            </select>

            <label for="impressaoDigital">Já teve impressão digital dos dedos coletada?</label>
            <select id="impressaoDigital" name="impressaoDigital">
                <option value="">Selecione</option>
                <option value="Sim">Sim</option>
                <option value="Não">Não</option>
            </select>

            <div id="previousUSVisaInfo">
                <label for="dataUltimaVisita">Data da última visita aos EUA:</label>
                <input type="date" id="dataUltimaVisita" name="dataUltimaVisita">

                <label for="tempoUltimaVisita">Tempo de estadia na última visita:</label>
                <input type="text" id="tempoUltimaVisita" name="tempoUltimaVisita">

                <label for="numeroVistoAnterior">Número do visto anterior (se aplicável):</label>
                <input type="text" id="numeroVistoAnterior" name="numeroVistoAnterior">
            </div>

            <label for="outrosPaises">Países visitados nos últimos 5 anos:</label>
            <textarea id="outrosPaises" name="outrosPaises"></textarea>

            <label for="vistoNegado">Já teve um visto americano negado?</label>
            <select id="vistoNegado" name="vistoNegado">
                <option value="">Selecione</option>
                <option value="Sim">Sim</option>
                <option value="Não">Não</option>
            </select>

            <label for="entradaRecusada">Já foi negada admissão aos EUA ou teve entrada recusada?</label>
            <select id="entradaRecusada" name="entradaRecusada">
                <option value="">Selecione</option>
                <option value="Sim">Sim</option>
                <option value="Não">Não</option>
            </select>

            <div id="visaDeniedDetails">
                <label for="detalhesVistoNegado">Detalhes da negativa (data e motivo):</label>
                <textarea id="detalhesVistoNegado" name="detalhesVistoNegado"></textarea>
            </div>

            <div class="declaration-section">
                <h3>Declaração</h3>
                <p>Eu, <input type="text" id="declaracaoNome" name="declaracaoNome" placeholder="Nome completo" required>, declaro, sob as penas da lei, que li e compreendi integralmente todas as questões contidas nesta solicitação de visto e afirmo que as respostas por mim fornecidas são verdadeiras, completas e corretas, conforme o meu melhor conhecimento e convicção.</p>

                <p><strong>Declaro estar ciente de que:</strong></p>
                <ol>
                    <li>Qualquer declaração falsa, incompleta ou enganosa poderá resultar na recusa permanente do visto ou na negativa de admissão nos Estados Unidos, conforme disposto na legislação aplicável.</li>
                    <li>Todas as informações prestadas nesta solicitação constituem declarações juramentadas, realizadas sob pena de perjúrio, nos termos do disposto no <em>28 U.S.C. § 1746</em>.</li>
                    <li>Informações adicionais poderão ser requisitadas pelas autoridades competentes após a análise desta solicitação, sendo minha responsabilidade fornecê-las tempestivamente.</li>
                    <li>As informações contidas nesta solicitação poderão ser compartilhadas com outras agências governamentais dos Estados Unidos, que possuem autoridade para utilizá-las para fins de aplicação da lei ou para propósitos imigratórios, conforme permitido pela legislação vigente.</li>
                    <li>A fotografia fornecida com esta solicitação poderá ser utilizada pelas autoridades americanas para fins de verificação de identidade, empregabilidade ou outros objetivos legais previstos na legislação dos Estados Unidos.</li>
                </ol>

                <p><strong>Declaro ainda:</strong></p>
                <ol start="6">
                    <li>Que sou exclusivamente responsável pela autenticidade e exatidão dos documentos apresentados e das informações prestadas nesta solicitação.</li>
                    <li>Que tenho pleno conhecimento de que a concessão ou negativa do visto é prerrogativa exclusiva da Autoridade Consular Americana, não cabendo a terceiros qualquer ingerência sobre tal decisão.</li>
                    <li>Que estou ciente de que, em processos de renovação de visto, entrevistas presenciais poderão ser exigidas a critério exclusivo da Autoridade Consular Americana.</li>
                    <li>Que reconheço que o serviço contratado constitui assessoria relacionada ao processo de preenchimento de documentação, agendamento de biometria e entrevista, não abrangendo serviços de entrega ou retirada de documentos no Centro de Atendimento ao Solicitante de Visto (CASV), sendo necessária a contratação de um agente colaborador, caso eu deseje tais serviços adicionais.</li>
                    <li>Que a aposição de minha assinatura eletrônica neste documento possui validade jurídica, conforme a legislação aplicável, e representa meu reconhecimento expresso dos serviços contratados.</li>
                </ol>

                <p><strong>Autorização:</strong></p>
                <p>Declaro, por fim, ter revisado e conferido todos os dados por mim apresentados, autorizando expressamente a empresa **Objetivo Turismo Ltda.**, contratada diretamente por mim ou por intermédio de minha agência, a proceder com o envio eletrônico do Formulário DS-160 ao Consulado Americano, bem como a realizar o pagamento das taxas e o agendamento necessários à tramitação do meu pedido de visto.</p>

                <label for="declaracaoLocal">Local:</label>
                <input type="text" id="declaracaoLocal" name="declaracaoLocal" required>

                <label for="declaracaoData">Data:</label>
                <input type="date" id="declaracaoData" name="declaracaoData" required>

                <label>Concordo com os termos desta declaração <input type="checkbox" id="aceiteDeclaracao" name="aceiteDeclaracao" required style="width: auto; margin-left: 10px;"></label>
            </div>

            <button type="submit">Enviar Formulário</button>
        </form>
    </div>

    <script type="module">
        // Importa as funções necessárias do Firebase SDK
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-app.js";
        import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-storage.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.5.0/firebase-analytics.js";

        // Configuração do Firebase com suas credenciais
        const firebaseConfig = {
            apiKey: "AIzaSyAkBV0rHEghBOHl2mDOs6rMDHkUgYMxFr0",
            authDomain: "visaformulariostorage.firebaseapp.com",
            projectId: "visaformulariostorage",
            storageBucket: "visaformulariostorage.firebasestorage.app",
            messagingSenderId: "720170394408",
            appId: "1:720170394408:web:b1c294c39c489388f6261d",
            measurementId: "G-ZFCV4JEEFT"
        };

        // Inicializa o Firebase
        const app = initializeApp(firebaseConfig);
        const storage = getStorage(app);
        const analytics = getAnalytics(app);

        // Funções de formatação
        function formatCPF(input) {
            let value = input.value.replace(/\D/g, ''); // Remove tudo que não é número
            if (value.length > 11) value = value.slice(0, 11); // Limita a 11 dígitos
            value = value.replace(/(\d{3})(\d)/, '$1.$2'); // Adiciona o primeiro ponto
            value = value.replace(/(\d{3})(\d)/, '$1.$2'); // Adiciona o segundo ponto
            value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2'); // Adiciona o traço
            input.value = value;
        }

        function formatCEP(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length > 8) value = value.slice(0, 8);
            if (value.length > 5) {
                value = value.replace(/(\d{2})(\d{3})(\d{3})/, '$1.$2-$3');
            } else if (value.length > 2) {
                value = value.replace(/(\d{2})(\d+)/, '$1.$2');
            }
            input.value = value;
        }

        function formatDateBr(dateStr) {
            if (!dateStr) return 'Não informado';
            const [year, month, day] = dateStr.split('-');
            const date = new Date(year, month - 1, day);
            return date.toLocaleDateString('pt-BR', { timeZone: 'America/Sao_Paulo' });
        }

        // Funções de toggle (mantidas as originais do seu código)
        // O importante aqui é que elas adicionarão/removerão a classe 'section-visible'
        // em vez de alterar diretamente o 'display'
        function toggleSpouseInfo() {
            const estadoCivil = document.getElementById('estadoCivil'); [cite: 64, 65]
            const spouseInfo = document.getElementById('spouseInfo'); [cite: 65]
            const spouseDeathInfo = document.getElementById('spouseDeathInfo'); [cite: 65]
            if (['Casado', 'Divorciado', 'Viúvo', 'União Estável'].includes(estadoCivil.value)) { [cite: 65]
                spouseInfo.classList.add('section-visible');
                // Adicionei uma pequena pausa para o CSS animar o spouseInfo antes de mudar o spouseDeathInfo
                setTimeout(() => {
                    if (estadoCivil.value === 'Viúvo') { [cite: 66]
                        spouseDeathInfo.classList.add('section-visible');
                    } else {
                        spouseDeathInfo.classList.remove('section-visible');
                        // Limpa os campos quando ocultado
                        spouseDeathInfo.querySelectorAll('input, textarea, select').forEach(input => input.value = '');
                    }
                }, 50); // Pequeno atraso para a transição
            } else {
                spouseInfo.classList.remove('section-visible');
                spouseDeathInfo.classList.remove('section-visible'); // Garante que também seja oculto
                // Limpa todos os campos da seção quando ela é ocultada
                spouseInfo.querySelectorAll('input, textarea, select').forEach(input => input.value = '');
                spouseDeathInfo.querySelectorAll('input, textarea, select').forEach(input => input.value = '');
            }
        }

        function toggleParentsInfo() {
            const temPaisVivos = document.getElementById('temPaisVivos'); [cite: 67, 68]
            const parentsInfo = document.getElementById('parentsInfo'); [cite: 68]
            if (temPaisVivos.value === 'Sim') { [cite: 68]
                parentsInfo.classList.add('section-visible');
                // Reavalia a sub-seção imediatamente após a seção principal aparecer
                setTimeout(toggleParentsInUSInfo, 50); // Pequeno atraso
            } else {
                parentsInfo.classList.remove('section-visible');
                parentsInfo.querySelectorAll('input, textarea, select').forEach(input => input.value = '');
                // Garante que a sub-seção também seja ocultada e limpa
                document.getElementById('parentsInUSInfo').classList.remove('section-visible');
                document.getElementById('parentsInUSInfo').querySelectorAll('input, textarea, select').forEach(input => input.value = '');
            }
        }

        function toggleParentsInUSInfo() {
            const paisNosEUA = document.getElementById('paisNosEUA'); [cite: 69, 70]
            const parentsInUSInfo = document.getElementById('parentsInUSInfo'); [cite: 70]
            if (paisNosEUA.value === 'Sim') { [cite: 70]
                parentsInUSInfo.classList.add('section-visible');
            } else {
                parentsInUSInfo.classList.remove('section-visible');
                parentsInUSInfo.querySelectorAll('input, textarea, select').forEach(input => input.value = '');
            }
        }

        function toggleTravelCompanionsInfo() {
            const temCompanheiros = document.getElementById('temCompanheiros'); [cite: 71, 72]
            const travelCompanionsInfo = document.getElementById('travelCompanionsInfo'); [cite: 72]
            if (temCompanheiros.value === 'Sim') { [cite: 72]
                travelCompanionsInfo.classList.add('section-visible');
            } else {
                travelCompanionsInfo.classList.remove('section-visible');
                travelCompanionsInfo.querySelectorAll('input, textarea, select').forEach(input => input.value = '');
            }
        }

        function togglePreviousUSVisaInfo() {
            const visitouEUA = document.getElementById('visitouEUA'); [cite: 73, 74]
            const previousUSVisaInfo = document.getElementById('previousUSVisaInfo'); [cite: 74]
            if (visitouEUA.value === 'Sim') { [cite: 74]
                previousUSVisaInfo.classList.add('section-visible');
            } else {
                previousUSVisaInfo.classList.remove('section-visible');
                previousUSVisaInfo.querySelectorAll('input, textarea, select').forEach(input => input.value = '');
            }
        }

        function toggleVisaDeniedDetails() {
            const vistoNegado = document.getElementById('vistoNegado'); [cite: 75, 76]
            const entradaRecusada = document.getElementById('entradaRecusada'); [cite: 76]
            const visaDeniedDetails = document.getElementById('visaDeniedDetails'); [cite: 76]
            if (vistoNegado.value === 'Sim' || entradaRecusada.value === 'Sim') { [cite: 76, 77]
                visaDeniedDetails.classList.add('section-visible');
            } else {
                visaDeniedDetails.classList.remove('section-visible');
                visaDeniedDetails.querySelectorAll('input, textarea, select').forEach(input => input.value = '');
            }
        }

        function togglePayerInfo() {
            const quemPaga = document.getElementById('quemPaga'); [cite: 77, 78]
            const payerInfo = document.getElementById('payerInfo'); [cite: 78]
            if (quemPaga.value === 'Outra pessoa') { [cite: 78]
                payerInfo.classList.add('section-visible');
                // Reavalia a sub-seção imediatamente após a seção principal aparecer
                setTimeout(togglePayerAddressInfo, 50); // Pequeno atraso
            } else {
                payerInfo.classList.remove('section-visible');
                payerInfo.querySelectorAll('input, textarea, select').forEach(input => input.value = '');
                // Garante que a sub-seção também seja ocultada e limpa
                document.getElementById('payerAddressInfo').classList.remove('section-visible');
                document.getElementById('payerAddressInfo').querySelectorAll('input, textarea, select').forEach(input => input.value = '');
            }
        }

        function togglePayerAddressInfo() {
            const payerSameAddress = document.getElementById('payerSameAddress'); [cite: 79, 80]
            const payerAddressInfo = document.getElementById('payerAddressInfo'); [cite: 80]
            if (payerSameAddress.value === 'Não') { [cite: 80]
                payerAddressInfo.classList.add('section-visible');
            } else {
                payerAddressInfo.classList.remove('section-visible');
                payerAddressInfo.querySelectorAll('input, textarea, select').forEach(input => input.value = '');
            }
        }

        function toggleRenewalInfo() {
            const primeiroVisto = document.getElementById('primeiroVisto'); [cite: 81, 82]
            const renewalInfo = document.getElementById('renewalInfo'); [cite: 82]
            if (primeiroVisto.value === 'Renovação') { [cite: 82]
                renewalInfo.classList.add('section-visible');
            } else {
                renewalInfo.classList.remove('section-visible');
                renewalInfo.querySelectorAll('input, textarea, select').forEach(input => input.value = '');
            }
        }

        function toggleAcquaintancesInfo() {
            const temConhecidosEUA = document.getElementById('temConhecidosEUA'); [cite: 83, 84]
            const acquaintancesInfo = document.getElementById('acquaintancesInfo'); [cite: 84]
            if (temConhecidosEUA.value === 'Sim') { [cite: 84]
                acquaintancesInfo.classList.add('section-visible');
            } else {
                acquaintancesInfo.classList.remove('section-visible');
                acquaintancesInfo.querySelectorAll('input, textarea, select').forEach(input => input.value = '');
            }
        }

        // Adicionando event listeners e chamadas iniciais
        document.addEventListener('DOMContentLoaded', () => {
            // Adicionando listeners
            document.getElementById('estadoCivil').addEventListener('change', toggleSpouseInfo); [cite: 87]
            document.getElementById('temPaisVivos').addEventListener('change', toggleParentsInfo); [cite: 87]
            document.getElementById('paisNosEUA').addEventListener('change', toggleParentsInUSInfo); [cite: 87]
            document.getElementById('temConhecidosEUA').addEventListener('change', toggleAcquaintancesInfo); [cite: 87]
            document.getElementById('quemPaga').addEventListener('change', togglePayerInfo); [cite: 87]
            document.getElementById('payerSameAddress').addEventListener('change', togglePayerAddressInfo); [cite: 88]
            document.getElementById('temCompanheiros').addEventListener('change', toggleTravelCompanionsInfo); [cite: 88]
            document.getElementById('primeiroVisto').addEventListener('change', toggleRenewalInfo); [cite: 88]
            document.getElementById('visitouEUA').addEventListener('change', togglePreviousUSVisaInfo); [cite: 89]
            document.getElementById('vistoNegado').addEventListener('change', toggleVisaDeniedDetails); [cite: 89]
            document.getElementById('entradaRecusada').addEventListener('change', toggleVisaDeniedDetails); [cite: 89]
            document.getElementById('visaForm').addEventListener('submit', generatePDF); [cite: 89]

            // Chamadas iniciais para definir o estado correto no carregamento da página
            toggleSpouseInfo();
            toggleParentsInfo();
            toggleParentsInUSInfo(); // Chamada dentro de toggleParentsInfo, mas pode ser chamada aqui para garantir
            toggleAcquaintancesInfo();
            togglePayerInfo();
            togglePayerAddressInfo(); // Chamada dentro de togglePayerInfo, mas pode ser chamada aqui para garantir
            toggleTravelCompanionsInfo();
            toggleRenewalInfo();
            togglePreviousUSVisaInfo();
            toggleVisaDeniedDetails();
        });


        // Função para gerar o PDF
        async function generatePDF(event) {
            event.preventDefault(); [cite: 90]
            try {
                const { jsPDF } = window.jspdf; [cite: 90, 91]
                const form = document.getElementById('visaForm'); [cite: 91]
                const formData = new FormData(form); [cite: 91]
                const solicitanteNome = formData.get('nome') || formData.get('declaracaoNome') || 'Não informado'; [cite: 91]
                const fixedWhatsAppNumber = '5561999998165'; [cite: 92]

                const doc = new jsPDF(); [cite: 92]
                const pageWidth = doc.internal.pageSize.width; [cite: 92]
                const pageHeight = doc.internal.pageSize.height; [cite: 92]
                const margin = 10; [cite: 93]
                let yPosition = 30; [cite: 93]

                function drawHeader() {
                    doc.setFillColor(0, 48, 135); /* Azul Marinho */ [cite: 93, 94]
                    doc.rect(0, 0, pageWidth, 25, 'F'); [cite: 94]
                    doc.setFontSize(16); [cite: 94]
                    doc.setTextColor(255, 255, 255); /* Branco */ [cite: 94]
                    doc.setFont("Helvetica", "bold"); [cite: 94]
                    const title = "Formulário de Solicitação de Visto Americano"; [cite: 94, 95]
                    const titleWidth = doc.getTextWidth(title); [cite: 95]
                    const titleX = (pageWidth - titleWidth) / 2; [cite: 95]
                    doc.text(title, titleX, 15); [cite: 95]
                    doc.setFontSize(14); [cite: 95]
                    const starSpacing = 8; [cite: 95, 96]
                    for (let i = 0; i < 3; i++) { [cite: 96]
                        doc.text("*", titleX - (i + 1) * starSpacing - 5, 15); [cite: 96]
                        doc.text("*", titleX + titleWidth + (i + 1) * starSpacing + 5, 15); [cite: 97]
                    }
                }

                function drawPageBorder() {
                    doc.setDrawColor(0, 48, 135); /* Azul Marinho */ [cite: 98]
                    doc.setLineWidth(0.5); [cite: 99]
                    doc.rect(margin / 2, margin / 2, pageWidth - margin, pageHeight - margin); [cite: 99, 100]
                }

                function addSectionTitle(title) {
                    if (yPosition + 15 > pageHeight - margin) { [cite: 100]
                        doc.addPage(); [cite: 100, 101]
                        yPosition = 30; [cite: 101]
                        drawHeader(); [cite: 101]
                        drawPageBorder(); [cite: 101]
                    }
                    doc.setFillColor(200, 16, 46); /* Vermelho */ [cite: 101, 102]
                    doc.rect(margin, yPosition - 5, pageWidth - 2 * margin, 10, 'F'); [cite: 102]
                    doc.setFontSize(12); [cite: 102]
                    doc.setTextColor(255, 255, 255); /* Branco */ [cite: 102]
                    doc.setFont("Helvetica", "bold"); [cite: 102, 103]
                    doc.text(title, margin + 5, yPosition + 2); [cite: 103]
                    yPosition += 15; [cite: 104]
                }

                function addText(text, isBold = false) {
                    const maxWidth = pageWidth - 2 * margin; [cite: 104, 105]
                    const lineHeight = 7; [cite: 105]
                    const lines = doc.splitTextToSize(text, maxWidth); [cite: 105]

                    doc.setFont("Helvetica", isBold ? "bold" : "normal"); [cite: 105]
                    doc.setTextColor(0, 0, 0); /* Preto */ [cite: 105]
                    doc.setFontSize(10); [cite: 105]
                    for (let i = 0; i < lines.length; i++) { [cite: 106]
                        if (yPosition + lineHeight > pageHeight - margin) { [cite: 106]
                            doc.addPage(); [cite: 106, 107]
                            yPosition = 30; [cite: 107]
                            drawHeader(); [cite: 107]
                            drawPageBorder(); [cite: 107]
                        }
                        doc.text(lines[i], margin, yPosition); [cite: 107, 108]
                        yPosition += lineHeight; [cite: 108]
                    }
                    yPosition += 2; [cite: 109]
                }
                
                function addJustifiedText(text) {
                    const maxWidth = pageWidth - 2 * margin; [cite: 109, 110]
                    const lineHeight = 7; [cite: 110]
                    doc.setFont("Helvetica", "normal"); [cite: 110]
                    doc.setTextColor(0, 0, 0); [cite: 110]
                    doc.setFontSize(10); [cite: 110]

                    const parts = text.split(/(\*\*.*?\*\*|_.*?_)/g);
                    let currentX = margin;

                    for (let i = 0; i < parts.length; i++) {
                        let part = parts[i];
                        let fontStyle = "normal";

                        if (part.startsWith('**') && part.endsWith('**')) {
                            fontStyle = "bold";
                            part = part.substring(2, part.length - 2); // Remove os asteriscos
                        } else if (part.startsWith('_') && part.endsWith('_')) {
                            fontStyle = "italic";
                            part = part.substring(1, part.length - 1); // Remove os underscores
                        }
                        doc.setFont("Helvetica", fontStyle);

                        const words = part.trim().split(/\s+/); [cite: 113]
                        for (let j = 0; j < words.length; j++) {
                            const word = words[j];
                            const wordWidth = doc.getTextWidth(word);

                            if (currentX + wordWidth > pageWidth - margin) {
                                yPosition += lineHeight; [cite: 117]
                                currentX = margin;
                                if (yPosition + lineHeight > pageHeight - margin) { [cite: 111]
                                    doc.addPage(); [cite: 112]
                                    yPosition = 30; [cite: 112]
                                    drawHeader(); [cite: 112]
                                    drawPageBorder(); [cite: 112]
                                    currentX = margin;
                                }
                            }
                            doc.text(word, currentX, yPosition); [cite: 112, 115, 116]
                            currentX += wordWidth + doc.getTextWidth(' ');
                        }
                    }
                    yPosition += lineHeight; [cite: 117]
                }


                drawHeader();
                drawPageBorder();

                addSectionTitle("Informações Pessoais"); [cite: 118]
                addText(`Nome: ${formData.get('nome') || 'Não informado'}`, true); [cite: 119]
                addText(`Sobrenome: ${formData.get('sobrenome') || 'Não informado'}`); [cite: 119]
                addText(`Outros Nomes: ${formData.get('outrosNomes') || 'Não informado'}`); [cite: 119, 120]
                addText(`CPF: ${formData.get('cpf') || 'Não informado'}`); [cite: 120]
                addText(`Data de Nascimento: ${formatDateBr(formData.get('nascimento'))}`); [cite: 120]
                addText(`Local de Nascimento: ${formData.get('localNascimento') || 'Não informado'}`); [cite: 120]
                addText(`Sexo: ${formData.get('sexo') || 'Não informado'}`); [cite: 121]
                addText(`Estado Civil: ${formData.get('estadoCivil') || 'Não informado'}`); [cite: 121]

                const estadoCivil = formData.get('estadoCivil'); [cite: 121, 122]
                if (['Casado', 'Divorciado', 'Viúvo', 'União Estável'].includes(estadoCivil)) { [cite: 122]
                    addSectionTitle("Dados do Cônjuge"); [cite: 122, 123]
                    addText(`Nome do Cônjuge: ${formData.get('spouseNome') || 'Não informado'}`); [cite: 123]
                    addText(`Data de Nascimento do Cônjuge: ${formatDateBr(formData.get('spouseNascimento'))}`); [cite: 123, 124]
                    addText(`Local de Nascimento do Cônjuge: ${formData.get('spouseLocalNascimento') || 'Não informado'}`); [cite: 124]
                    if (estadoCivil === 'Viúvo') { [cite: 124]
                        addText(`Data de Falecimento do Cônjuge: ${formatDateBr(formData.get('spouseFalecimento'))}`); [cite: 125]
                    }
                }

                addText(`Nacionalidade: ${formData.get('nacionalidade') || 'Não informado'}`); [cite: 125, 126]
                addText(`Outras Nacionalidades: ${formData.get('outrasNacionalidades') || 'Não informado'}`); [cite: 126]
                addText(`Número do Passaporte: ${formData.get('passaporte') || 'Não informado'}`); [cite: 126]
                addText(`Data de Emissão do Passaporte: ${formatDateBr(formData.get('dataEmissaoPassaporte'))}`); [cite: 126, 127]
                addText(`Data de Validade do Passaporte: ${formatDateBr(formData.get('dataValidadePassaporte'))}`); [cite: 127]
                addText(`Local de Emissão do Passaporte: ${formData.get('localEmissaoPassaporte') || 'Não informado'}`); [cite: 127]

                addSectionTitle("Informações de Contato"); [cite: 127, 128]
                addText(`CEP: ${formData.get('cep') || 'Não informado'}`); [cite: 128]
                addText(`Endereço: ${formData.get('endereco') || 'Não informado'}`); [cite: 128]
                addText(`Cidade: ${formData.get('cidade') || 'Não informado'}`); [cite: 128]
                addText(`Estado: ${formData.get('estado') || 'Não informado'}`); [cite: 129]
                addText(`País: ${formData.get('pais') || 'Não informado'}`); [cite: 129]
                addText(`Telefone: ${formData.get('telefone') || 'Não informado'}`); [cite: 129]
                addText(`E-mail: ${formData.get('email') || 'Não informado'}`); [cite: 129]

                addSectionTitle("Informações Familiares"); [cite: 129, 130]
                addText(`Pais Vivos: ${formData.get('temPaisVivos') || 'Não informado'}`); [cite: 130]
                if (formData.get('temPaisVivos') === 'Sim') { [cite: 130]
                    addText(`Nome do Pai: ${formData.get('nomePai') || 'Não informado'}`); [cite: 130, 131]
                    addText(`Data de Nascimento do Pai: ${formatDateBr(formData.get('nascimentoPai'))}`); [cite: 131]
                    addText(`Nome da Mãe: ${formData.get('nomeMae') || 'Não informado'}`); [cite: 131]
                    addText(`Data de Nascimento da Mãe: ${formatDateBr(formData.get('nascimentoMae'))}`); [cite: 131, 132]
                    addText(`Pais nos EUA: ${formData.get('paisNosEUA') || 'Não informado'}`); [cite: 132]
                    if (formData.get('paisNosEUA') === 'Sim') { [cite: 132]
                        addText(`Explicação sobre Pais nos EUA: ${formData.get('explicacaoPaisEUA') || 'Não informado'}`); [cite: 133]
                    }
                }
                addText(`Conhecidos nos EUA: ${formData.get('temConhecidosEUA') || 'Não informado'}`); [cite: 133, 134]
                if (formData.get('temConhecidosEUA') === 'Sim') { [cite: 134]
                    addText(`Nome do Conhecido: ${formData.get('nomeConhecido') || 'Não informado'}`); [cite: 134, 135]
                    addText(`Telefone do Conhecido: ${formData.get('telefoneConhecido') || 'Não informado'}`); [cite: 135]
                    addText(`E-mail do Conhecido: ${formData.get('emailConhecido') || 'Não informado'}`); [cite: 135, 136]
                    addText(`Vínculo com o Conhecido: ${formData.get('vinculoConhecido') || 'Não informado'}`); [cite: 136]
                }

                addSectionTitle("Detalhes da Viagem"); [cite: 136, 137]
                addText(`Objetivo da Viagem: ${formData.get('objetivo') || 'Não informado'}`); [cite: 137]
                addText(`Data de Chegada: ${formatDateBr(formData.get('chegada'))}`); [cite: 137]
                addText(`Tempo de Estadia: ${formData.get('tempo') || 'Não informado'}`); [cite: 137, 138]
                addText(`Endereço nos EUA: ${formData.get('enderecoEUA') || 'Não informado'}`); [cite: 138]
                addText(`Quem Paga a Viagem: ${formData.get('quemPaga') || 'Não informado'}`); [cite: 138, 139]
                if (formData.get('quemPaga') === 'Outra pessoa') { [cite: 139]
                    addText(`Nome do Pagante: ${formData.get('payerNome') || 'Não informado'}`); [cite: 139, 140]
                    addText(`Endereço Igual ao Solicitante: ${formData.get('payerSameAddress') || 'Não informado'}`); [cite: 140]
                    if (formData.get('payerSameAddress') === 'Não') { [cite: 140]
                        addText(`CEP do Pagante: ${formData.get('payerCEP') || 'Não informado'}`); [cite: 140, 141]
                        addText(`Endereço do Pagante: ${formData.get('payerEndereco') || 'Não informado'}`); [cite: 141]
                        addText(`Cidade do Pagante: ${formData.get('payerCidade') || 'Não informado'}`); [cite: 141, 142]
                        addText(`Estado do Pagante: ${formData.get('payerEstado') || 'Não informado'}`); [cite: 142]
                        addText(`País do Pagante: ${formData.get('payerPais') || 'Não informado'}`); [cite: 142, 143]
                    }
                    addText(`E-mail do Pagante: ${formData.get('payerEmail') || 'Não informado'}`); [cite: 143, 144]
                    addText(`Telefone do Pagante: ${formData.get('payerTelefone') || 'Não informado'}`); [cite: 144]
                    addText(`Vínculo com o Pagante: ${formData.get('payerVinculo') || 'Não informado'}`); [cite: 144, 145]
                }
                addText(`Companheiros de Viagem: ${formData.get('temCompanheiros') || 'Não informado'}`); [cite: 145, 146]
                if (formData.get('temCompanheiros') === 'Sim') { [cite: 146]
                    addText(`Nome do(s) Companheiro(s): ${formData.get('nomeCompanheiro') || 'Não informado'}`); [cite: 146, 147]
                    addText(`Relação com o(s) Companheiro(s): ${formData.get('relacaoCompanheiro') || 'Não informado'}`); [cite: 147]
                }

                addSectionTitle("Informações de Trabalho"); [cite: 147, 148]
                addText(`Ocupação: ${formData.get('ocupacao') || 'Não informado'}`); [cite: 148]
                addText(`Empregador: ${formData.get('empregador') || 'Não informado'}`); [cite: 148]
                addText(`Endereço do Empregador: ${formData.get('enderecoEmpregador') || 'Não informado'}`); [cite: 148, 149]
                addText(`Telefone do Empregador: ${formData.get('telefoneEmpregador') || 'Não informado'}`); [cite: 149]
                addText(`Data de Início no Trabalho: ${formatDateBr(formData.get('dataInicioTrabalho'))}`); [cite: 149]
                addText(`Renda Mensal: ${formData.get('rendaMensal') || 'Não informado'}`); [cite: 149, 150]
                addSectionTitle("Informações de Educação"); [cite: 150]
                addText(`Nível de Educação: ${formData.get('nivelEducacao') || 'Não informado'}`); [cite: 150]
                addText(`Instituição: ${formData.get('instituicao') || 'Não informado'}`); [cite: 150, 151]
                addText(`Endereço da Instituição: ${formData.get('enderecoInstituicao') || 'Não informado'}`); [cite: 151]
                addText(`Data de Início do Curso: ${formatDateBr(formData.get('dataInicioEducacao'))}`); [cite: 151]
                addText(`Data de Conclusão do Curso: ${formatDateBr(formData.get('dataFimEducacao'))}`); [cite: 151, 152]
                addSectionTitle("Histórico de Viagens"); [cite: 152]
                addText(`Primeiro Visto ou Renovação: ${formData.get('primeiroVisto') || 'Não informado'}`); [cite: 152, 153]
                if (formData.get('primeiroVisto') === 'Renovação') { [cite: 153]
                    addText(`Número do Visto Anterior: ${formData.get('numeroVistoAnteriorRenovacao') || 'Não informado'}`); [cite: 153, 154]
                    addText(`Data de Emissão do Visto Anterior: ${formatDateBr(formData.get('dataEmissaoVistoAnterior'))}`); [cite: 154]
                    addText(`Data de Validade do Visto Anterior: ${formatDateBr(formData.get('dataValidadeVistoAnterior'))}`); [cite: 154, 155]
                    addText(`Local de Emissão do Visto Anterior: ${formData.get('localEmissaoVistoAnterior') || 'Não informado'}`); [cite: 155, 156]
                }
                addText(`Já Visitou os EUA: ${formData.get('visitouEUA') || 'Não informado'}`); [cite: 156, 157]
                if (formData.get('visitouEUA') === 'Sim') { [cite: 157]
                    addText(`Data da Última Visita: ${formatDateBr(formData.get('dataUltimaVisita'))}`); [cite: 157, 158]
                    addText(`Tempo da Última Visita: ${formData.get('tempoUltimaVisita') || 'Não informado'}`); [cite: 158]
                    addText(`Número do Visto Anterior: ${formData.get('numeroVistoAnterior') || 'Não informado'}`); [cite: 158, 159]
                }
                addText(`Impressão Digital Coletada: ${formData.get('impressaoDigital') || 'Não informado'}`); [cite: 159, 160]
                addText(`Países Visitados (Últimos 5 Anos): ${formData.get('outrosPaises') || 'Não informado'}`); [cite: 160]
                addText(`Visto Negado: ${formData.get('vistoNegado') || 'Não informado'}`); [cite: 160, 161]
                addText(`Entrada Recusada nos EUA: ${formData.get('entradaRecusada') || 'Não informado'}`); [cite: 161]

                if (formData.get('vistoNegado') === 'Sim' || formData.get('entradaRecusada') === 'Sim') { [cite: 161]
                    addText(`Detalhes da Negativa: ${formData.get('detalhesVistoNegado') || 'Não informado'}`); [cite: 162]
                }

                addSectionTitle("Declaração"); [cite: 162]
                addText(`Nome: ${solicitanteNome}`, true); [cite: 162, 163]
                addText(`Local: ${formData.get('declaracaoLocal') || 'Não informado'}`); [cite: 163]
                addText(`Data: ${formatDateBr(formData.get('declaracaoData'))}`); [cite: 163]
                addText(`Aceite dos Termos: ${formData.get('aceiteDeclaracao') ? 'Sim' : 'Não'}`); [cite: 163, 164]
                addJustifiedText(`Eu, ${solicitanteNome}, declaro, sob as penas da lei, que li e compreendi integralmente todas as questões contidas nesta solicitação de visto e afirmo que as respostas por mim fornecidas são verdadeiras, completas e corretas, conforme o meu melhor conhecimento e convicção.`); [cite: 164]
                addJustifiedText("Declaro estar ciente de que:"); [cite: 165]
                addJustifiedText("1. Qualquer declaração falsa, incompleta ou enganosa poderá resultar na recusa permanente do visto ou na negativa de admissão nos Estados Unidos, conforme disposto na legislação aplicável."); [cite: 165, 166]
                addJustifiedText("2. Todas as informações prestadas nesta solicitação constituem declarações juramentadas, realizadas sob pena de perjúrio, nos termos do disposto no _28 U.S.C. § 1746_."); [cite: 166]
                addJustifiedText("3. Informações adicionais poderão ser requisitadas pelas autoridades competentes após a análise desta solicitação, sendo minha responsabilidade fornecê-las tempestivamente."); [cite: 167]
                addJustifiedText("4. As informações contidas nesta solicitação poderão ser compartilhadas com outras agências governamentais dos Estados Unidos, que possuem autoridade legal para utilizá-las para fins de aplicação da lei ou para propósitos imigratórios, conforme permitido pela legislação vigente."); [cite: 168]
                addJustifiedText("5. A fotografia fornecida com esta solicitação poderá ser utilizada pelas autoridades americanas para fins de verificação de identidade, empregabilidade ou outros objetivos legais previstos na legislação dos Estados Unidos."); [cite: 169]
                addJustifiedText("Declaro ainda:"); [cite: 170]
                addJustifiedText("6. Que sou exclusivamente responsável pela autenticidade e exatidão dos documentos apresentados e das informações prestadas nesta solicitação."); [cite: 170, 171]
                addJustifiedText("7. Que tenho pleno conhecimento de que a concessão ou negativa do visto é prerrogativa exclusiva da Autoridade Consular Americana, não cabendo a terceiros qualquer ingerência sobre tal decisão."); [cite: 171, 172]
                addJustifiedText("8. Que estou ciente de que, em processos de renovação de visto, entrevistas presenciais poderão ser exigidas a critério exclusivo da Autoridade Consular Americana."); [cite: 172, 173]
                addJustifiedText("9. Que reconheço que o serviço contratado constitui assessoria relacionada ao processo de preenchimento de documentação, agendamento de biometria e entrevista, não abrangendo serviços de entrega ou retirada de documentos no Centro de Atendimento ao Solicitante de Visto (CASV), sendo necessária a contratação de um agente colaborador, caso eu deseje tais serviços adicionais."); [cite: 173, 174]
                addJustifiedText("10. Que a aposição de minha assinatura eletrônica neste documento possui validade jurídica, conforme a legislação aplicável, e representa meu reconhecimento expresso dos serviços contratados."); [cite: 174, 175]
                addJustifiedText("Autorização:"); [cite: 175]
                addJustifiedText(`Declaro, por fim, ter revisado e conferido todos os dados por mim apresentados, autorizando expressamente a empresa Objetivo Turismo Ltda., contratada diretamente por mim ou por intermédio de minha agência, a proceder com o envio eletrônico do Formulário DS-160 ao Consulado Americano, bem como a realizar o pagamento das taxas e o agendamento necessários à tramitação do meu pedido de visto.`); [cite: 175]
                
                // Salva o PDF no navegador
                const fileName = `Formulario_Visto_Americano_${solicitanteNome.replace(/\s+/g, '_')}.pdf`;
                doc.save(fileName); [cite: 176]

                const pdfBlob = doc.output('blob'); [cite: 176]
                const timestamp = Date.now(); [cite: 176]
                const firebaseFileName = `pdfs/formulario_visto_${formData.get('nome') || 'sem_nome'}_${timestamp}.pdf`;
                const storageRef = ref(storage, firebaseFileName); [cite: 176]

                await uploadBytes(storageRef, pdfBlob); [cite: 177]
                const downloadUrl = await getDownloadURL(storageRef); [cite: 177]

                const whatsappMessage = `Formulário de Visto Americano preenchido por ${formData.get('nome') || 'Não informado'}.\nPassaporte: ${formData.get('passaporte') || 'Não informado'}\nClique no link para visualizar e baixar o PDF: ${downloadUrl}`; [cite: 177, 178]
                const whatsappUrl = `https://api.whatsapp.com/send?phone=${fixedWhatsAppNumber}&text=${encodeURIComponent(whatsappMessage)}`; [cite: 178]
                window.open(whatsappUrl, '_blank'); [cite: 179]

                alert('Formulário enviado com sucesso! O PDF foi baixado e uma mensagem com o link foi enviada ao WhatsApp.'); [cite: 179]

            } catch (error) {
                console.error('Erro ao gerar PDF ou enviar para o WhatsApp:', error); [cite: 180]
                alert('Erro ao processar o formulário. Verifique o console para mais detalhes.'); [cite: 181]
            }
        }
    </script>
</body>
</html>
